<html>
<style>
    textarea {
        background-color: black;
        color: white;
        height: 200px;
        width: 200px;
    }

    .status {
        background-color: blue;
        color: red;
        height: 20px;
        width: 20px;
        font-size: large;
        font-weight: 700;
    }
</style>

<script>
    var thread = new Worker('ajax.js');

    function pop() {
        thread.postMessage({ 'command': "pop" });
    }

    function push() {
        var pushData = document.getElementById("data").value;

        thread.postMessage({ 'command': "push", 'data': pushData });
        popup("pushed");
    }

    function serialize() {
        thread.postMessage({ 'command': "serialize" });
        popup("serialized");
    }

    function popResultHandler(result) {
        document.getElementById("result").value = result;
    }

    function pushResultHandler(result) {

    }

    function serializeResultHandler(result) {

        document.getElementById("allData").value = result;

    }


    function popup(txt) {
        document.getElementById("status").innerHTML = txt;
        setTimeout(function () {
            document.getElementById("status").innerHTML = "";
        }, 3000);

    }

    thread.onmessage = responseHandler;

    function responseHandler(e) {
        console.log("Response Handler:", e);

            var result = e.data;

            const command = result.command;
            const data = result.response;
            const status = result.status;
            
            console.log("Response Handler:", data);

            switch (command) {
                case "pop": popResultHandler(data);
                    break;
                case "push": pushResultHandler(data);
                    break;
                case "serialize": serializeResultHandler(data);
                    break;

                default: console.log("Un handled response");
            }
    }


</script>
<h1>Stack</h1>
<label id="status" class="status"></label>
<br />
<br />
<br />

<label>push:</label>
<textarea id="data"></textarea>
<button onclick="push()">push</button>

<br />

<label>pop:</label>
<textarea id="result"></textarea>
<button onclick="pop()">pop</button>
<br />

<label>All Data:</label>
<textarea id="allData"></textarea>
<button onclick="serialize()">serialize</button>
<br />

</html>